---
title: "Portfolio for Computational Musicology"
author: "Tisja Smits"
output: 
    flexdashboard::flex_dashboard:
        storyboard: true
        theme: journal
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(spotifyr)
library(compmus)
library(flexdashboard)
library(plotly)
```

### Week 5

The corpus I am going to analyze consists of four playlists: my Top Tracks of 2019, my Top Tracks of 2020, the Top Tracks NL of 2019 and the Top Tracks NL of 2020. These playlists are respectively representative of the following groups I will be comparing: my taste in music in 2019, my taste in music in 2020, the average Dutch taste in music in 2019, and the average Dutch taste in music in 2020.
In this portfolio, I want to find an answer to the following questions:
1. How did my taste in music in 2020 differ from 2019? (comparison between group 1 and 2)
2. How did the average Dutch taste in music in 2020 differ from 2019? (comparison between group 3 and 4)
3. How average was my taste in music in 2019? (comparison between group 1 and 3)
4. How average was my taste in music in 2020? (comparison between group 2 and 4)

I find it very interesting to analyze these comparisons, especially in light of the coronavirus pandemic. Due to the social distancing measures I did not listen to music in any social setting, such as hanging out with friends, clubbing, or even working out at the gym. My hypothesis is that my taste in music was therefore *less* average in 2020 than it was in 2019.

Evidently, my corpus is representative for the groups I want to compare, because it actually consists of those groups. However, I do have to remark that a Top Tracks playlist might not be representative of 'the average'. It just contains those tracks that were listened to most often. On the same note, I do not have a premium Spotify account, which means I do not often skip a song and most playlists are on shuffle. It might just be that a song was eligible as Top Track because it was in a playlist I listened to a lot, not because I liked that song so much.

For example, *Stuck with U* by Ariana Grande and Justin Bieber is one of my Top Tracks of 2020. It used to be in a lot of different playlists I listened to at the time. And yes, I liked that song, but nevertheless, I am fairly sure there were other songs I liked more in 2020 that did not appear in that playlist. I definitely consider this song atypical for the group 'my taste in music in 2020'.

On the other hand, a song I consider very typical for my taste in music in 2019 is *Drive and Disconnect* by Nao. I remember listening to this song on repeat when I discovered it, but also for a longer time after that. And even a few months later I rediscovered this song, and the flame was rekindled.

While browsing the API Reference, I found the following variables that seem interesting to analyze: genres, artists, popularity, danceability, energy, valence, speechiness, instrumentalness, key, mode, tempo.

***
Feedback
- Can Top Tracks NL be considered average? Which demographic contributes most to the creation of the playlist? And do I belong to that demographic?
- With my free account, Spotify might be biasing my taste in music by making me listen to certain (sponsored?) songs (such as that Ariana Grande song).
- Will the fact that I cannot skip (many) songs influence the comparison scores?
- How many songs are in each of the playlists?
***


### Week 6

```{r toptracks table, echo=FALSE}
NL2020 <- get_playlist_audio_features("", "37i9dQZF1DWU7JsJYlV18s")
my2020 <- get_playlist_audio_features("", "37i9dQZF1ELZX0wn2u2RJw")
NL2019 <- get_playlist_audio_features("", "37i9dQZF1DX24O9ZrSq8yt")
my2019 <- get_playlist_audio_features("", "37i9dQZF1Etf5utVpuKPi7")

toptracks <-
  bind_rows(
    NL2020 %>% mutate(playlist = "NL 2020"),
    my2020 %>% mutate(playlist = "My 2020"),
    NL2019 %>% mutate(playlist = "NL 2019"),
    my2019 %>% mutate(playlist = "My 2019")
  )
  # %>% mutate(mode = ifelse(mode == 0, "minor", "major"))

```

```{r toptracks plot, include=FALSE}
ggplot(toptracks,
       aes(
         x = valence,
         y = energy,
         color = mode
       )
      ) +
  geom_point() +              # Scatter plot.
  #geom_point(summarise_all(toptracks, mean), shape = 15)
  geom_rug(size = 0.1) +      # Add 'fringes' to show data distribution.
  facet_wrap(~playlist) +     # Separate charts per mode
  theme_light()               # Use a simpler theme.

ggplot(toptracks,
       aes(
         x = tempo,
         y = danceability,
         color = mode
       )
      ) +
  geom_point() +              # Scatter plot.
  #geom_point(summarise_all(toptracks, mean), shape = 15)
  geom_rug(size = 0.1) +      # Add 'fringes' to show data distribution.
  facet_wrap(~playlist) +     # Separate charts per mode
  theme_light()               # Use a simpler theme.
```

```{r energy violin plot, echo=FALSE}
energy_violin <- ggplot(toptracks,
    aes(
      x = playlist,
      y = energy,          # Interestingly different
      color = playlist
    )
  ) +
  geom_violin(trim=FALSE) +
  stat_summary(fun.y=mean, geom="point", shape=16, size=4) +
  #geom_boxplot(width=0.1) +
  #scale_y_continuous(limits=c(0,1)) +
  theme_minimal() +
  theme(legend.position = "none") +
  labs(
    x = "Playlist",
    y = "Energy"
  )
ggplotly(energy_violin)
```

```{r valence violin plot, echo=FALSE}
valence_violin <- ggplot(toptracks,
    aes(
      x = playlist,
      y = valence,        # Interestingly similar
      color = playlist
    )
  ) +
  geom_violin(trim=FALSE) +
  stat_summary(fun.y=mean, geom="point", shape=16, size=4) +
  #geom_boxplot(width=0.1) +
  #scale_y_continuous(limits=c(0,1)) +
  theme_minimal() +
  theme(legend.position = "none") +
  labs(
    x = "Playlist",
    y = "Valence"
  )
ggplotly(valence_violin)
```

```{r danceability violin plot, echo=FALSE}
danceability_violin <- ggplot(toptracks,
    aes(
      x = playlist,
      y = danceability,    # Taste more average in 2020 than in 2019?
      color = playlist
    )
  ) +
  geom_violin(trim=FALSE) +
  stat_summary(fun.y=mean, geom="point", shape=16, size=4) +
  #geom_boxplot(width=0.1) +
  #scale_y_continuous(limits=c(0,1)) +
  theme_minimal() +
  theme(legend.position = "none") +
  labs(
    x = "Playlist",
    y = "Danceability"
  )
ggplotly(danceability_violin)
```

***
The following violin plots show the distribution of energy, valence and danceability, respectively, along the four chosen playlists.

The first violin plot shows that, with respect to the energy level, my taste in music has remained very constant. In both My Top Tracks of 2019 and Top Tracks NL of 2019, there is a bump around 0.7. They also spread out downward quite equally. This, however, was not the case in 2020; energy was *lower* on average and more spread out, though with a small bump *higher* than the bumps of the other playlists. Thus, Top Tracks NL 2019 is more similar to my Top Tracks playlists than Top Tracks NL 2020, with respect to the energy level that is.

The second violin plot shows that, with respect to the valence level, my taste in music has remained fairly constant, although valence was more spread out in My Top Tracks of 2020 than in My Top Tracks of 2019. Interestingly, valence in Top Tracks NL 2019 is very nicely and equally distributed, unlike Top Tracks NL 2020. In fact, Top Tracks NL 2020 seems to have the inverted valence distribution of my Top Tracks playlists.

The third violin plot shows that, with respect to the danceability level, my taste in music has remained somewhat constant, with the bumps of My Top Tracks of 2019 and My Top Tracks of 2020 both at around 0.75. Unlike in the plots above, this plot shows that, with respect to danceability, playlists are more similar when grouping by year than they are when grouping by 'personal versus NL'. Not only the shapes look more similar, the mean dancibilities seem to follow the same trend as well; the mean dancibility was slightly lower in 2020 than in 2019. This could be explained by the fact that, due to social distancing measures, there were less occasions to dance. As a result, artists also made less music *to dance to*.


```{r, include=FALSE}
ggplot(toptracks,
    aes(
      x = playlist,
      fill = mode
    )
  ) +
  geom_bar(position = "fill") +
  theme_light()

ggplot(toptracks,
    aes(
      x = playlist,
      y = speechiness
    )
  ) +
  geom_violin() +
  theme_light()

ggplot(toptracks,
    aes(
      x = playlist,
      y = acousticness
    )
  ) +
  geom_violin() +
  theme_light()

ggplot(toptracks,
    aes(
      x = playlist,
      y = tempo
    )
  ) +
  geom_violin() +
  theme_light()
```




### Week 7



